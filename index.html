<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Bee Clicker: Royal Edition ğŸ</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#ffcc00">
<link rel="apple-touch-icon" href="icone.png">
<link rel="icon" type="image/png" href="icone.png">

<style>
:root{
  --bg1:#87ceeb; --bg2:#fff3b0; --card:#fff;
  --accent:#ffcc00; --dark:#4a3b00; --shadow:0 10px 25px rgba(0,0,0,.18);
  --xp-bar:#4caf50;
  --common: #b2bec3;
  --rare: #0984e3;
  --epic: #a29bfe;
}

*{ box-sizing:border-box; user-select:none; -webkit-tap-highlight-color:transparent; touch-action: manipulation; }

body{
  margin:0; font-family:system-ui, -apple-system, sans-serif;
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  display:flex; justify-content:center; min-height: 100vh; overflow-x: hidden;
}

/* TELA DE INÃCIO */
#startScreen {
    position: fixed; inset: 0; background: linear-gradient(180deg, var(--accent), var(--bg2));
    z-index: 5000; display: flex; flex-direction: column; align-items: center; justify-content: center;
    transition: opacity 0.5s ease;
}
.start-logo { font-size: 80px; animation: float 3s infinite ease-in-out; }
.start-title { font-size: 32px; font-weight: 900; color: var(--dark); margin: 20px 0; }

.game{ width:100%; max-width:420px; padding:14px; position: relative; display: flex; flex-direction: column; opacity: 0; transition: opacity 0.5s; }

.card{
  background:var(--card); border-radius:20px; padding:15px;
  box-shadow:var(--shadow); text-align:center; position: relative;
}

.notif-card { height: 60px; margin: 10px 0; display: flex; align-items: center; padding: 0 20px; overflow: hidden; }
.notif-icon-fixed { font-size: 20px; margin-right: 15px; opacity: 0.6; flex-shrink: 0; }
#notifContainer { flex: 1; height: 100%; position: relative; display: flex; align-items: center; justify-content: center; }

.save-icon { position: absolute; left: 15px; top: 18px; font-size: 18px; opacity: 0; transition: 0.3s; z-index: 10; }
.save-icon.visible { opacity: 1; }

.top-btns { position: absolute; right: 15px; top: 18px; display: flex; gap: 8px; }
.circle-btn {
  background: #eee; border: none; border-radius: 50%;
  width: 34px; height: 34px; font-size: 18px;
  display: flex; align-items: center; justify-content: center; cursor: pointer;
}

.level-container { margin-top: 10px; text-align: left; }
.level-info { display: flex; justify-content: space-between; font-weight: bold; font-size: 14px; margin-bottom: 4px; color: var(--dark); }
.xp-bg { width: 100%; height: 12px; background: #eee; border-radius: 10px; overflow: hidden; }
.xp-fill { height: 100%; background: var(--xp-bar); width: 0%; transition: width 0.5s; }
.stats{ margin-top:6px; font-size:18px; font-weight: bold; color: var(--dark); }

.popup {
    position: absolute; background: #f8f9fa; padding: 6px 15px; border-radius: 12px;
    font-weight: 800; font-size: 12px; white-space: nowrap; border-left: 4px solid var(--common);
    animation: slideInOut 4s ease-in-out forwards;
}
.popup.rare { border-left-color: var(--rare); background: #e3f2fd; }
.popup.epic { border-left-color: var(--epic); background: #f3f0ff; }

@keyframes slideInOut {
    0% { transform: translateX(-120%); opacity: 0; }
    10% { transform: translateX(0); opacity: 1; }
    90% { transform: translateX(0); opacity: 1; }
    100% { transform: translateX(120%); opacity: 0; }
}

#active-boosts { position: absolute; top: -35px; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; z-index: 10; }
.boost-tag {
    font-size: 18px; background: white; border-radius: 50%; width: 28px; height: 28px;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); border: 2px solid var(--accent);
}

.click-zone{ display:grid; grid-template-columns:1fr auto 1fr; align-items:center; gap:10px; margin: 15px 0; }
.aura-wrapper{ position:relative; width:170px; height:170px; display:flex; justify-content:center; align-items:center; }
.aura{ position:absolute; width:140px; height:140px; border-radius:50%; filter:blur(15px); opacity:.3; transition: all 0.2s; }
.bee{ font-size:100px; z-index:2; animation:float 3s ease-in-out infinite; cursor: pointer; }

@keyframes float{ 0%, 100%{transform:translateY(0) rotate(0deg);} 50%{transform:translateY(-15px) rotate(3deg);} }

.target{ height:80px; border-radius:15px; border:3px dashed #ffcc00; display:flex; align-items:center; justify-content:center; font-size:30px; opacity:.5; }

button{
  width:100%; padding:14px; margin-top:10px; border:none; border-radius:14px;
  font-size:15px; font-weight:700; background:var(--accent); color:var(--dark);
  box-shadow:0 5px 0 #c9a200; cursor: pointer; transition: 0.1s;
}
button:active{ transform:translateY(2px); box-shadow:0 3px 0 #c9a200; }
button:disabled{ background:#ccc !important; color:#777 !important; box-shadow: none !important; }

.modal{ position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; justify-content:center; align-items:center; z-index:500; padding: 20px; }
.modal-box{ background:#fff; width:100%; max-width:400px; border-radius:20px; overflow:hidden; display: flex; flex-direction: column; animation: modalIn 0.3s ease-out; }

.modal-header{ padding:15px; background: var(--accent); font-weight:800; display:flex; justify-content:space-between; align-items: center; color: var(--dark); }
.modal-body{ padding:0; max-height:70vh; overflow-y:auto; }

.acc-item { border-bottom: 1px solid #eee; }
.acc-header { padding: 15px; background: #fff; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 800; font-size: 14px; }
.acc-content { max-height: 0; overflow: hidden; background: #fafafa; transition: max-height 0.3s ease-out; }
.acc-body { padding: 15px; font-size: 13px; line-height: 1.5; }
.acc-item.active .acc-content { max-height: 400px; }

.shop-item { display: flex; align-items: center; justify-content: space-between; padding: 15px; border-bottom: 1px solid #eee; gap: 10px; }
.buy-btn { width: auto; padding: 8px 14px; margin: 0; font-size: 12px; }

.filter-bar { display: flex; justify-content: center; gap: 15px; padding: 12px; background: #f8f9fa; border-bottom: 1px solid #eee; }
.filter-dot { width: 38px; height: 38px; border-radius: 50%; border: 2px solid #ddd; background: white; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: 0.2s; }
.filter-dot.active { border-color: var(--dark); transform: scale(1.1); }

.ach-card { display: flex; align-items: center; padding: 12px; border-radius: 15px; background: #f9f9f9; border: 2px solid transparent; text-align: left; gap: 15px; margin: 10px; }
.ach-card.unlocked.common { border-color: var(--common); background: #f1f2f6; }
.ach-card.unlocked.rare { border-color: var(--rare); background: #e3f2fd; }
.ach-card.unlocked.epic { border-color: var(--epic); background: #f3f0ff; }
.locked { filter: grayscale(1); opacity: 0.5; }
</style>
</head>

<body>

<div id="startScreen">
    <div class="start-logo">ğŸ</div>
    <div class="start-title">BEE CLICKER</div>
    <button style="width: 200px;" onclick="startGame()">JOGAR</button>
    <div style="margin-top: 20px; font-size: 12px; opacity: 0.7;">Royal Edition v1.5</div>
</div>

<div class="game" id="gameUI">
  <div class="card">
    <div id="saveIndicator" class="save-icon">ğŸ’¾</div>
    <div class="top-btns">
        <button class="circle-btn" id="btnShop">ğŸ›’</button>
        <button class="circle-btn" id="btnHelp">â“</button>
    </div>
    <div style="font-size: 24px; font-weight: 900; margin-top: 12px;">Bee Clicker ğŸ</div>
    <div class="stats">ğŸ¯ <span id="honey">0</span> | âš¡ <span id="mps">0</span>/s</div>
    <div class="level-container">
      <div class="level-info"><span>NÃ­vel <span id="lvlDisplay">1</span></span><span id="xpDisplay">0 / 100</span></div>
      <div class="xp-bg"><div class="xp-fill" id="xpFill"></div></div>
    </div>
  </div>

  <div class="card notif-card">
      <div class="notif-icon-fixed">ğŸ“¢</div>
      <div id="notifContainer"></div>
  </div>

  <div class="card">
    <div class="click-zone">
      <div class="target" id="leftTarget">ğŸ¯</div>
      <div class="aura-wrapper">
        <div id="active-boosts"></div>
        <div class="aura" id="aura"></div>
        <div id="bee" class="bee">ğŸ</div>
      </div>
      <div class="target" id="rightTarget">ğŸ¯</div>
    </div>
  </div>

  <div class="card" style="margin-top:14px;">
    <button id="btnUpgradeClick">ğŸ–±ï¸ Upgrade Clique â€“ 10 ğŸ¯</button>
    <button id="btnAutoAction">âš¡ Desbloquear Auto â€“ 100 ğŸ¯</button>
    <button id="openAchievements" style="background:#eee; box-shadow:0 5px 0 #ccc;">ğŸ† Conquistas (<span id="achCount">0</span>/200)</button>
  </div>
</div>

<div class="modal" id="shopModal"><div class="modal-box"><div class="modal-header">ğŸ›’ Loja <span onclick="closeModal('shopModal')" style="cursor:pointer">Ã—</span></div><div class="modal-body"><div class="shop-item"><div class="shop-info"><b>ğŸŒ¶ï¸ Pimenta</b><small>3x mel por 30s.</small></div><button class="buy-btn" onclick="buyBoost('pepper', 500)">500 ğŸ¯</button></div><div class="shop-item"><div class="shop-info"><b>ğŸ¥¤ EnergÃ©tico</b><small>2x mel e vel. por 20s.</small></div><button class="buy-btn" onclick="buyBoost('energy', 300)">300 ğŸ¯</button></div><div class="shop-item"><div class="shop-info"><b>ğŸŒ¼ Flor Dourada</b><small>5x XP por 15s.</small></div><button class="buy-btn" onclick="buyBoost('flower', 1000)">1000 ğŸ¯</button></div></div></div></div>

<div class="modal" id="helpModal">
  <div class="modal-box">
    <div class="modal-header">ğŸ“– Guia & Backup <span onclick="closeModal('helpModal')" style="cursor:pointer">Ã—</span></div>
    <div class="modal-body">
        <div class="acc-item active"><div class="acc-header" onclick="toggleAcc(this)">ğŸ Objetivo <span>â–¼</span></div><div class="acc-content"><div class="acc-body">Clique na abelha ou alvos para mel e XP.</div></div></div>
        <div class="acc-item"><div class="acc-header" onclick="toggleAcc(this)">â˜ï¸ Backup de Dados <span>â–¼</span></div><div class="acc-content"><div class="acc-body">
            Use os botÃµes abaixo para salvar seu progresso fora do celular:<br><br>
            <button onclick="exportSave()" style="background:#444; color:white; font-size:12px; height:35px; padding:0;">COPIAR CÃ“DIGO DE SAVE</button>
            <button onclick="importSave()" style="background:#888; color:white; font-size:12px; height:35px; padding:0;">RESTAURAR CÃ“DIGO</button>
        </div></div></div>
    </div>
  </div>
</div>

<div class="modal" id="offlineModal"><div class="modal-box"><div class="modal-header">ğŸ ProduÃ§Ã£o Offline!</div><div class="modal-body" style="text-align:center; padding:20px;"><div style="font-size:50px">ğŸ¯</div><p id="offlineText"></p><button id="btnCollectOffline" style="background:var(--xp-bar);color:white">COLETAR</button></div></div></div>
<div class="modal" id="achModal"><div class="modal-box"><div class="modal-header">ğŸ† Conquistas <span onclick="closeModal('achModal')" style="cursor:pointer">Ã—</span></div><div class="filter-bar"><div class="filter-dot dot-all active" onclick="setAchFilter('all', this)">ğŸŒ</div><div class="filter-dot dot-common" onclick="setAchFilter('common', this)">âšª</div><div class="filter-dot dot-rare" onclick="setAchFilter('rare', this)">ğŸ”µ</div><div class="filter-dot dot-epic" onclick="setAchFilter('epic', this)">ğŸŸ£</div></div><div class="modal-body" id="achList"></div></div></div>

<script>
let honey=0, totalHoneyEver=0, clicks=0, hPerClick=1, clickCost=10, level=1, currentXP=0, nextLevelXP=100, autoUnlocked=false, autoLevel=1, autoCost=100, timeOnline=0, currentFilter='all';
let activeBoosts={pepper:0, energy:0, flower:0};
let pendingOfflineHoney=0, notificationQueue = [], isProcessingNotification = false;
const levelScale=1.35, autoBase=2;

function startGame() {
    document.getElementById('startScreen').style.opacity = '0';
    setTimeout(() => {
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('gameUI').style.opacity = '1';
        // Tenta fullscreen mobile
        const docEl = document.documentElement;
        const rfs = docEl.requestFullscreen || docEl.webkitRequestFullScreen;
        if(rfs) rfs.call(docEl);
    }, 500);
}

function notify(a) { notificationQueue.push(a); processQueue(); }
function processQueue() {
    if (isProcessingNotification || notificationQueue.length === 0) return;
    isProcessingNotification = true;
    const a = notificationQueue.shift();
    const container = document.getElementById("notifContainer");
    const div = document.createElement("div");
    div.className = `popup ${a.r}`;
    div.innerHTML = `${a.i} ${a.n}`;
    container.appendChild(div);
    setTimeout(() => { div.remove(); isProcessingNotification = false; processQueue(); }, 4000);
}

const achievements = [];
function initAchievements() {
    for(let i=0;i<15;i++) achievements.push({ n: `Pote #${i+1}`, d: `Acumule mel total`, c: () => totalHoneyEver >= [100,1000,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][i], u: false, i: "ğŸ¯", r: i < 5 ? "common" : (i < 10 ? "rare" : "epic") });
    for(let i=0;i<12;i++) achievements.push({ n: `Clique #${i+1}`, d: `Cliques manuais`, c: () => clicks >= [1,100,500,1000,5000,1e4,5e4,1e5,5e5,1e6,5e6,1e7][i], u: false, i: "ğŸ‘†", r: i < 4 ? "common" : (i < 8 ? "rare" : "epic") });
    for(let i=1; i<=100; i++) achievements.push({ n: `Rank #${i}`, d: `NÃ­vel ${i*10}`, c: () => level >= i*10, u: false, i: "ğŸ“ˆ", r: i < 15 ? "common" : (i < 45 ? "rare" : "epic") });
}
initAchievements();

function buyBoost(t, c) { if(honey>=c){ honey-=c; activeBoosts[t]+=(t==='pepper'?30:t==='energy'?20:15); updateUI(); notify({n:"Boost!", i:"ğŸš€", r:"rare"}); } }
function updateBoostTick() { const container = document.getElementById("active-boosts"); container.innerHTML = ""; const icons = {pepper:"ğŸŒ¶ï¸", energy:"ğŸ¥¤", flower:"ğŸŒ¼"}; for(let b in activeBoosts){ if(activeBoosts[b]>0){ activeBoosts[b]--; container.innerHTML+=`<div class="boost-tag">${icons[b]}</div>`; } } }
setInterval(updateBoostTick, 1000);

function getGlobalBonus() { 
    let rCount = achievements.filter(a => a.u && a.r === 'rare').length; 
    let eCount = achievements.filter(a => a.u && a.r === 'epic').length; 
    let mult = 1 + (rCount * 0.01) + (eCount * 0.05); 
    if(activeBoosts.pepper > 0) mult *= 3; 
    if(activeBoosts.energy > 0) mult *= 2; 
    return mult; 
}

function updateUI() {
    document.getElementById("honey").textContent = Math.floor(honey).toLocaleString();
    document.getElementById("mps").textContent = autoUnlocked ? Math.floor((autoBase * autoLevel) * getGlobalBonus()) : 0;
    document.getElementById("lvlDisplay").textContent = level;
    document.getElementById("xpDisplay").textContent = `${Math.floor(currentXP)} / ${nextLevelXP}`;
    document.getElementById("xpFill").style.width = `${Math.min(100, (currentXP / nextLevelXP) * 100)}%`;
    document.getElementById("achCount").textContent = achievements.filter(a => a.u).length;
    document.getElementById("btnUpgradeClick").textContent = `ğŸ–±ï¸ Upgrade Clique â€“ ${clickCost}`;
    document.getElementById("btnAutoAction").textContent = !autoUnlocked ? `âš¡ Desbloquear Auto â€“ ${autoCost}` : `âš¡ Upgrade Auto â€“ ${autoCost}`;
}

document.getElementById("btnAutoAction").onclick = () => { if(honey >= autoCost){ honey -= autoCost; if(!autoUnlocked){autoUnlocked=true;autoCost=200;startAuto();} else{autoLevel++;autoCost=Math.floor(autoCost*1.85);} updateUI(); executeSave(); } };
document.getElementById("btnUpgradeClick").onclick = () => { if(honey >= clickCost){ honey -= clickCost; hPerClick++; clickCost=Math.floor(clickCost*1.7); updateUI(); executeSave(); } };

function doClick() { const gain = hPerClick * getGlobalBonus(); honey += gain; totalHoneyEver += gain; clicks++; addXP(gain); clickBuffer.push(Date.now()); updateUI(); }
function addXP(amt) { let xpMult = (activeBoosts.flower > 0) ? 5 : 1; currentXP += (amt * xpMult); while(currentXP >= nextLevelXP){ currentXP -= nextLevelXP; level++; nextLevelXP = Math.floor(nextLevelXP * levelScale); notify({n:`NÃ­vel ${level}!`, i:"âœ¨", r:'common'}); } }
function startAuto() { setInterval(() => { const amt = (autoBase * autoLevel) * getGlobalBonus(); honey += amt; totalHoneyEver += amt; addXP(amt); updateUI(); }, 1000); }

let clickBuffer = [];
setInterval(() => {
    const cps = clickBuffer.filter(t => Date.now() - t < 1000).length;
    const aura = document.getElementById("aura"), bee = document.getElementById("bee");
    let s=1, o=.3, c="rgba(255,204,0,.4)", sp=3;
    if(activeBoosts.energy > 0) sp = 0.5;
    if(cps > 4){ s=1.2; o=.5; c="rgba(255,160,0,.6)"; sp = Math.min(sp, 2); }
    if(cps > 10){ s=1.4; o=.8; c="rgba(255,80,0,.8)"; sp = Math.min(sp, 1.2); }
    if(aura){ aura.style.transform=`scale(${s})`; aura.style.opacity=o; aura.style.background=`radial-gradient(circle, ${c}, transparent 70%)`; }
    if(bee) bee.style.animationDuration=`${sp}s`;
    achievements.forEach(a => { if(!a.u && a.c()){ a.u = true; notify(a); executeSave(); } });
}, 100);

function executeSave() {
    const data = {honey, totalHoneyEver, clicks, hPerClick, clickCost, level, currentXP, nextLevelXP, autoUnlocked, autoLevel, autoCost, timeOnline, achs:achievements.map(a=>a.u), timestamp:Date.now()};
    localStorage.setItem('BeeRoyal_Cloud_V1', JSON.stringify(data));
    document.getElementById("saveIndicator").classList.add("visible");
    setTimeout(() => document.getElementById("saveIndicator").classList.remove("visible"), 2000);
}

function exportSave() {
    const data = localStorage.getItem('BeeRoyal_Cloud_V1');
    const encoded = btoa(data); // Transforma em cÃ³digo
    navigator.clipboard.writeText(encoded);
    alert("CÃ³digo de Backup copiado! Salve-o onde preferir.");
}

function importSave() {
    const code = prompt("Cole seu cÃ³digo de Backup aqui:");
    if(code) {
        try {
            const decoded = atob(code);
            localStorage.setItem('BeeRoyal_Cloud_V1', decoded);
            location.reload();
        } catch(e) { alert("CÃ³digo invÃ¡lido!"); }
    }
}

function load() {
    const raw = localStorage.getItem('BeeRoyal_Cloud_V1');
    if(raw){
        const d = JSON.parse(raw);
        honey=d.honey; totalHoneyEver=d.totalHoneyEver; clicks=d.clicks; hPerClick=d.hPerClick; clickCost=d.clickCost; level=d.level; currentXP=d.currentXP; nextLevelXP=d.nextLevelXP; autoUnlocked=d.autoUnlocked; autoLevel=d.autoLevel; autoCost=d.autoCost; timeOnline=d.timeOnline||0;
        if(d.achs) d.achs.forEach((u,i) => { if(achievements[i]) achievements[i].u = u; });
        if(autoUnlocked && d.timestamp){
            const mps = (autoBase * autoLevel) * getGlobalBonus();
            const off = Math.floor((Date.now()-d.timestamp)/1000);
            if(off > 15){ pendingOfflineHoney = off * mps; document.getElementById("offlineText").innerHTML=`Suas abelhas produziram <b>${Math.floor(pendingOfflineHoney).toLocaleString()}</b> mel!`; openModal('offlineModal'); }
        }
        if(autoUnlocked) startAuto();
    }
    updateUI();
}

function openModal(id){document.getElementById(id).style.display="flex";}
function closeModal(id){document.getElementById(id).style.display="none";}
function toggleAcc(h){ const i=h.parentElement, a=i.classList.contains('active'); document.querySelectorAll('.acc-item').forEach(x=>x.classList.remove('active')); if(!a)i.classList.add('active'); }
function setAchFilter(t,b){ currentFilter=t; document.querySelectorAll('.filter-dot').forEach(x=>x.classList.remove('active')); b.classList.add('active'); renderAchs(); }
function renderAchs(){ const l=document.getElementById("achList"); l.innerHTML=""; achievements.filter(a=>currentFilter==='all'||a.r===currentFilter).forEach(a=>{ l.innerHTML+=`<div class="ach-card ${a.u?'unlocked '+a.r:'locked'}"><div class="ach-icon">${a.u?a.i:'ğŸ”’'}</div><div class="ach-info"><b>${a.n}</b><br><small>${a.d}</small></div></div>`; }); }

document.getElementById("btnHelp").onclick = () => openModal('helpModal');
document.getElementById("btnShop").onclick = () => openModal('shopModal');
document.getElementById("openAchievements").onclick = () => { renderAchs(); openModal('achModal'); };
document.getElementById("btnCollectOffline").onclick = () => { honey+=pendingOfflineHoney; totalHoneyEver+=pendingOfflineHoney; addXP(pendingOfflineHoney); pendingOfflineHoney=0; closeModal('offlineModal'); updateUI(); executeSave(); };
window.onclick = (e) => { if(e.target.className==='modal') closeModal(e.target.id); };

["bee","leftTarget","rightTarget"].forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener("touchstart", (e) => { e.preventDefault(); doClick(); }, {passive:false});
    el.addEventListener("mousedown", (e) => { e.preventDefault(); doClick(); });
});

load();
</script>
</body>
</html>